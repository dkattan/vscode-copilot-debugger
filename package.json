{
  "name": "copilot-breakpoint-debugger",
  "displayName": "Copilot Breakpoint Debugger",
  "description": "Use GitHub Copilot to automate starting, inspecting and resuming VS Code debug sessions with conditional breakpoints, hit conditions, and logpoints.",
  "version": "0.0.1",
  "publisher": "dkattan",
  "preview": true,
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/dkattan/vscode-copilot-debugger"
  },
  "bugs": {
    "url": "https://github.com/dkattan/vscode-copilot-debugger/issues"
  },
  "homepage": "https://github.com/dkattan/vscode-copilot-debugger#readme",
  "icon": "images/icon.png",
  "engines": {
    "vscode": "^1.102.0"
  },
  "categories": [
    "Debuggers",
    "Other"
  ],
  "keywords": [
    "copilot",
    "debug",
    "breakpoint",
    "variables",
    "stack",
    "resume",
    "ai"
  ],
  "activationEvents": [
    "onLanguageModelTools"
  ],
  "main": "./out/extension.js",
  "contributes": {
    "configuration": {
      "title": "Copilot Breakpoint Debugger",
      "properties": {
        "copilot-debugger.defaultLaunchConfiguration": {
          "type": "string",
          "default": "",
          "description": "Name of the default launch configuration to use when starting the debugger"
        }
      }
    },
    "commands": [
      {
        "command": "copilot-debugger.helloWorld",
        "title": "Hello World"
      }
    ],
    "languageModelTools": [
      {
        "name": "start_debugger_with_breakpoints",
        "displayName": "Start Debugger",
        "toolReferenceName": "startDebugger",
        "canBeReferencedInPrompt": true,
        "userDescription": "Start a debugging session and wait for first breakpoint with optional variable filtering and custom breakpoints.",
        "modelDescription": "Start a debug session using the configured default launch configuration and wait until a breakpoint is hit, returning call stack and variables (optionally filtered).",
        "inputSchema": {
          "type": "object",
          "properties": {
            "workspaceFolder": {
              "type": "string",
              "description": "Absolute path of workspace folder (defaults to first workspace)."
            },
            "variableFilter": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "List of variable name regex fragments to filter variables (joined with |)."
            },
            "timeout_seconds": {
              "type": "integer",
              "description": "Seconds to wait for initial breakpoint (default 60)."
            },
            "breakpointConfig": {
              "type": "object",
              "properties": {
                "disableExisting": {
                  "type": "boolean",
                  "description": "If true, disables all existing breakpoints before adding new ones."
                },
                "breakpoints": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "path": {
                        "type": "string",
                        "description": "File path relative to workspace or absolute."
                      },
                      "line": {
                        "type": "integer",
                        "description": "1-based line number for the breakpoint."
                      },
                      "condition": {
                        "type": "string",
                        "description": "Optional conditional expression (e.g., 'x > 5'). Breakpoint only triggers when condition evaluates to true."
                      },
                      "hitCondition": {
                        "type": "string",
                        "description": "Optional hit count condition (e.g., '>10', '==5', '%3'). Breakpoint triggers based on hit count."
                      },
                      "logMessage": {
                        "type": "string",
                        "description": "Optional log message for logpoint. Uses curly braces for variable interpolation (e.g., 'Value is {x}')."
                      }
                    },
                    "required": [
                      "path",
                      "line"
                    ]
                  },
                  "description": "Optional list of breakpoints to add before starting session."
                }
              }
            }
          },
          "required": []
        }
      },
      {
        "name": "resume_debug_session",
        "displayName": "Resume Debug Session",
        "toolReferenceName": "resumeDebugSession",
        "canBeReferencedInPrompt": true,
        "userDescription": "Resume a paused debug session optionally waiting for the next breakpoint and applying new breakpoint configuration.",
        "modelDescription": "Resume execution of the specified debug session. Optionally wait for next stop and set/clear breakpoints before continuing.",
        "inputSchema": {
          "type": "object",
          "properties": {
            "sessionId": {
              "type": "string",
              "description": "ID of the debug session to resume."
            },
            "waitForStop": {
              "type": "boolean",
              "description": "If true, wait until the debugger stops again before returning."
            },
            "breakpointConfig": {
              "type": "object",
              "properties": {
                "disableExisting": {
                  "type": "boolean"
                },
                "breakpoints": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "path": {
                        "type": "string"
                      },
                      "line": {
                        "type": "integer"
                      },
                      "condition": {
                        "type": "string",
                        "description": "Optional conditional expression (e.g., 'x > 5'). Breakpoint only triggers when condition evaluates to true."
                      },
                      "hitCondition": {
                        "type": "string",
                        "description": "Optional hit count condition (e.g., '>10', '==5', '%3'). Breakpoint triggers based on hit count."
                      },
                      "logMessage": {
                        "type": "string",
                        "description": "Optional log message for logpoint. Uses curly braces for variable interpolation (e.g., 'Value is {x}')."
                      }
                    },
                    "required": [
                      "path",
                      "line"
                    ]
                  }
                }
              }
            }
          },
          "required": [
            "sessionId"
          ]
        }
      },
      {
        "name": "get_variables",
        "displayName": "Get Variables",
        "toolReferenceName": "getVariables",
        "canBeReferencedInPrompt": true,
        "userDescription": "Get all variables from the current debug session",
        "modelDescription": "Retrieve a list of all variables and their values from the current debug session when stopped at a breakpoint",
        "inputSchema": {
          "type": "object",
          "properties": {}
        }
      },
      {
        "name": "expand_variable",
        "displayName": "Expand Variable",
        "toolReferenceName": "expandVariable",
        "canBeReferencedInPrompt": true,
        "userDescription": "Show detailed contents and immediate children of a specific variable",
        "modelDescription": "Expand a specific variable to show its detailed contents and immediate child properties/elements when stopped at a breakpoint",
        "inputSchema": {
          "type": "object",
          "properties": {
            "variableName": {
              "type": "string",
              "description": "Name of the variable to expand"
            }
          },
          "required": [
            "variableName"
          ]
        }
      }
    ]
  },
  "scripts": {
    "vscode:prepublish": "npm run compile",
    "compile": "npm run format && tsc -p ./",
    "watch": "tsc -watch -p ./",
    "pretest": "npm run lint",
    "lint": "eslint src",
    "test": "npm run compile && node --enable-source-maps out/test/runTest.js",
    "format": "prettier --write .",
    "format:check": "prettier --check ."
  },
  "devDependencies": {
    "@types/mocha": "^10.0.10",
    "@types/node": "20.x",
    "@types/vscode": "^1.102.0",
    "@typescript-eslint/eslint-plugin": "^8.31.1",
    "@typescript-eslint/parser": "^8.31.1",
    "@vscode/test-cli": "^0.0.11",
    "@vscode/test-electron": "^2.5.2",
    "eslint": "^9.25.1",
    "eslint-config-prettier": "^10.1.8",
    "eslint-plugin-prettier": "^5.5.3",
    "prettier": "^3.6.2",
    "typescript": "^5.8.3",
    "ts-node": "^10.9.2"
  },
  "dependencies": {
    "debug-tracker-vscode": "^0.0.15"
  }
}
